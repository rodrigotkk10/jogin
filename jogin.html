<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Mini Space Impact</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: black;
    }
    canvas {
      display: block;
      background: #000;
    }
  </style>
</head>
<body>
<canvas id="game"></canvas>
<script>
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  canvas.width = 480;
  canvas.height = 320;

  const keys = {};

  const player = {
    x: 20,
    y: canvas.height / 2 - 15,
    width: 30,
    height: 15,
    speed: 4,
    bullets: [],
    cooldown: 0,
    shoot() {
      this.bullets.push({
        x: this.x + this.width,
        y: this.y + this.height / 2 - 2,
        width: 6,
        height: 4
      });
    }
  };

  let enemies = [];
  let score = 0;

  function spawnEnemy() {
    const y = Math.random() * (canvas.height - 20);
    enemies.push({ x: canvas.width, y, width: 20, height: 20 });
  }

  function update() {
    if (keys['ArrowUp'] && player.y > 0) player.y -= player.speed;
    if (keys['ArrowDown'] && player.y + player.height < canvas.height) player.y += player.speed;
    if (keys[' '] || keys['Spacebar']) {
      if (player.cooldown === 0) {
        player.shoot();
        player.cooldown = 10;
      }
    }
    if (player.cooldown > 0) player.cooldown--;

    // Atualiza tiros
    for (let i = player.bullets.length - 1; i >= 0; i--) {
      const b = player.bullets[i];
      b.x += 6;
      if (b.x > canvas.width) {
        player.bullets.splice(i, 1);
      }
    }

    // Atualiza inimigos
    for (let i = enemies.length - 1; i >= 0; i--) {
      const e = enemies[i];
      e.x -= 2;

      if (e.x + e.width < 0) {
        enemies.splice(i, 1);
        continue;
      }

      // Colisão com o jogador
      if (
        e.x < player.x + player.width &&
        e.x + e.width > player.x &&
        e.y < player.y + player.height &&
        e.y + e.height > player.y
      ) {
        alert('Game Over! Pontos: ' + score);
        document.location.reload();
        return;
      }
    }

    // Colisão dos tiros com inimigos
    for (let bi = player.bullets.length - 1; bi >= 0; bi--) {
      const b = player.bullets[bi];
      for (let ei = enemies.length - 1; ei >= 0; ei--) {
        const e = enemies[ei];
        if (
          b.x < e.x + e.width &&
          b.x + b.width > e.x &&
          b.y < e.y + e.height &&
          b.y + b.height > e.y
        ) {
          player.bullets.splice(bi, 1);
          enemies.splice(ei, 1);
          score++;
          break;
        }
      }
    }
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Player
    ctx.fillStyle = 'lime';
    ctx.fillRect(player.x, player.y, player.width, player.height);

    // Tiros
    ctx.fillStyle = 'yellow';
    for (const b of player.bullets) {
      ctx.fillRect(b.x, b.y, b.width, b.height);
    }

    // Inimigos
    ctx.fillStyle = 'red';
    for (const e of enemies) {
      ctx.fillRect(e.x, e.y, e.width, e.height);
    }

    // Pontuação
    ctx.fillStyle = 'white';
    ctx.font = '14px Arial';
    ctx.fillText('Pontos: ' + score, 10, 20);
  }

  function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
  }

  setInterval(spawnEnemy, 1200);
  document.addEventListener('keydown', e => keys[e.key] = true);
  document.addEventListener('keyup', e => keys[e.key] = false);
  loop();
</script>
</body>
</html>
